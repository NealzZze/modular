const canvas=document.getElementById("c1"),ctx=canvas.getContext("2d");let count,timer,stopCount,mas=[];canvas.onclick=function(a){let b=a.offsetX,c=a.offsetY;b=Math.floor(b/10),c=Math.floor(c/10),mas[c][b]=1,drawField()};function goLife(){for(let a=0;a<40;a++){mas[a]=[];for(let b=0;b<40;b++)mas[a][b]=0}}goLife();function drawField(){ctx.clearRect(0,0,400,400);for(let a=0;40>a;a++)for(let b=0;40>b;b++)1==mas[a][b]&&(ctx.lineCap="round",ctx.fillStyle="green",ctx.fillRect(10*b,10*a,10,10))}function startLife(){let a=[];for(let b=0;40>b;b++){a[b]=[];for(let c,d=0;40>d;d++)switch(c=0,mas[b][d]){case 1:1==mas[fpm(b)-1][d]&&c++,1==mas[b][fpp(d)+1]&&c++,1==mas[fpp(b)+1][d]&&c++,1==mas[b][fpm(d)-1]&&c++,1==mas[fpm(b)-1][fpp(d)+1]&&c++,1==mas[fpp(b)+1][fpp(d)+1]&&c++,1==mas[fpp(b)+1][fpm(d)-1]&&c++,1==mas[fpm(b)-1][fpm(d)-1]&&c++,a[b][d]=3==c||2==c?1:0;break;case 0:1==mas[fpm(b)-1][d]&&c++,1==mas[b][fpp(d)+1]&&c++,1==mas[fpp(b)+1][d]&&c++,1==mas[b][fpm(d)-1]&&c++,1==mas[fpm(b)-1][fpp(d)+1]&&c++,1==mas[fpp(b)+1][fpp(d)+1]&&c++,1==mas[fpp(b)+1][fpm(d)-1]&&c++,1==mas[fpm(b)-1][fpm(d)-1]&&c++,a[b][d]=3==c?1:0;}}mas=a,drawField(),count++,document.getElementById("count").innerHTML=count,timer=setTimeout(startLife,300),stopCount=0,mas.forEach(function(a){a.includes(1)||stopCount++}),40==stopCount&&stop()}function fpm(a){return 0==a?40:a}function fpp(a){return 39==a?-1:a}function stop(){clearTimeout(timer),timer=0}document.getElementById("start").onclick=function(){count=0,startLife()};